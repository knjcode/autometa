(function(){var e,o,l,s,n,r,c,g,a,t,i,p,f,u,d,h,S,m,v,F,x,y,N,q;for(g=require("fs"),v=require("xlsx"),s=require("ejs"),console.log("Input excel filename:",process.argv[2]),c=process.argv[2],console.log("options:",process.argv.slice(3,process.argv.length)),S=v.readFile(c),N=S.SheetNames,F=0,y=N.length;y>F;F++){for(d=N[F],console.log("SheetName: "+d),m=S.Sheets[d],t=m.A1.w,console.log("TemplateID: "+t),o="./"+t+".csv",console.log("CSV FileName: "+o),n="./"+t+".ejs",console.log("EJS FileName: "+n),e=g.readFileSync(o,"utf8"),p=[],u=e.split(String.fromCharCode(10)),a=x=0,q=u.length;q>=0?q>x:x>q;a=q>=0?++x:--x)l=u[a].split(","),""!==l[0]&&(p[l[0]]=l[1]);console.log("KeyMap:"),console.log(p);for(i in p)r=p[i],""!==i?p[i]=m[""+r].w:delete p[i];console.log("ExcelMappedKeyMap:"),console.log(p),h=g.readFileSync(n,"utf8"),f=s.render(h,p),console.log("Output:"),console.log(f)}console.log("end.")}).call(this);