(function(){var e,o,l,s,r,n,c,i,a,g,t,p,u,f,d,h,m,x,S,v,F,q,y,N,j,C,M;if(a=require("fs"),d=require("path"),q=require("xlsx"),F=require("xlsjs"),s=require("ejs"),console.log("Input excel filename:",process.argv[2]),c=process.argv[2],i=d.extname(c),console.log(i),console.log("options:",process.argv.slice(3,process.argv.length)),".xlsx"===i)S=q.readFile(c);else{if(".xls"!==i)return void console.log("error. check input filename.");S=F.readFile(c)}for(C=S.SheetNames,y=0,j=C.length;j>y;y++){for(m=C[y],console.log("SheetName: "+m),v=S.Sheets[m],t=v.A1.w,console.log("TemplateID: "+t),o="./"+t+".csv",console.log("CSV FileName: "+o),r="./"+t+".ejs",console.log("EJS FileName: "+r),e=a.readFileSync(o,"utf8"),u=[],h=e.split(String.fromCharCode(10)),g=N=0,M=h.length;M>=0?M>N:N>M;g=M>=0?++N:--N)l=h[g].split(","),""!==l[0]&&(u[l[0]]=l[1]);console.log("KeyMap:"),console.log(u);for(p in u)n=u[p],""!==p?u[p]=v[""+n].w:delete u[p];console.log("ExcelMappedKeyMap:"),console.log(u),x=a.readFileSync(r,"utf8"),f=s.render(x,u),console.log("Output:"),console.log(f)}console.log("end.")}).call(this);